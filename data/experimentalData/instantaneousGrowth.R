rm(list=ls())
source('R/functions-analyses.R')

# finn_rn_2002_m243_217_fig1_fig4_merged.csv
instantaneousGrowth(0.0868,0.0545,25.1457,18.0533)
instantaneousGrowth(0.1798,0.0868,31.9827,25.1457)
instantaneousGrowth(0.5124,0.1798,38.9918,31.9827)
instantaneousGrowth(1.665,0.5124,47.0266,38.9918)

# hogendoorn_h_1983_a35_1_table1.csv
instantaneousGrowth(1.59,1.54,21+1,1) # 21 days of deltaT
instantaneousGrowth(9.58,7.83,28+1,1) # 28 days of deltaT
instantaneousGrowth(50.5,50.0,28+1,1) # 28 days of deltaT
instantaneousGrowth(108 ,96.9,42+1,1) # 42 days of deltaT

# houde_ed_1983_m72_283
# see database-c-houde_ed_1983_m72_283_growth.R for details

# houlihan_df_1995_f14_195_fig1b.csv
instantaneousGrowth(0.1376, 0.1125, 14.0525, 13.0257)

# laurence_gc_1978_m50_1_fig1_fig3_merged.csv
instantaneousGrowth(48.50651, 56.50671, 10.9371, 4.0726)
instantaneousGrowth(57.42487, 48.50651, 18.9719, 10.9371)
instantaneousGrowth(65.59942, 57.42487, 24.967, 18.9719)
instantaneousGrowth(141.25375, 65.59942, 33.1175, 24.967)
instantaneousGrowth(249.22982, 141.25375, 41.2088, 33.1175)
instantaneousGrowth(51.07402, 50.45451, 10.1327, 2.8376)
instantaneousGrowth(55.41151, 51.07402, 16.9322, 10.1327)
instantaneousGrowth(85.78276, 55.41151, 24.0361, 16.9322)
instantaneousGrowth(159.3309, 85.78276, 31.0138, 24.0361)
instantaneousGrowth(264.36259, 159.3309, 38.055, 31.0138)
instantaneousGrowth(564.41689, 264.36259, 46.2055, 38.055)
instantaneousGrowth(1267.94379, 564.41689, 52.1916, 46.2055)
instantaneousGrowth(43.66164, 55.47534, 8.7746, 1.909)
instantaneousGrowth(67.05019, 43.66164, 16.9915, 8.7746)
instantaneousGrowth(99.33447, 67.05019, 23.1067, 16.9915)
instantaneousGrowth(287.14417, 99.33447, 30.1404, 23.1067)
instantaneousGrowth(538.02196, 287.14417, 37.1799, 30.1404)
instantaneousGrowth(2070.14135, 538.02196, 44.2715, 37.1799)

# laurence_gc_1978_m50_1_fig2_fig4_merged.csv
instantaneousGrowth(54.013211, 69.358549, 7.9517, 0.9668)
instantaneousGrowth(80.537844, 54.013211, 14.9149, 7.9517)
instantaneousGrowth(128.735997, 80.537844, 22.0285, 14.9149)
instantaneousGrowth(154.561029, 128.735997, 28.8971, 22.0285)
instantaneousGrowth(202.395103, 154.561029, 35.9664, 28.8971)
instantaneousGrowth(75.822832, 49.556429, 8.9588, 2.0475)
instantaneousGrowth(97.566337, 75.822832, 15.9779, 8.9588)
instantaneousGrowth(118.195244, 97.566337, 22.948, 15.9779)
instantaneousGrowth(152.089769, 118.195244, 29.8142, 22.948)
instantaneousGrowth(498.769628, 152.089769, 36.904, 29.8142)
instantaneousGrowth(87.096359, 46.238102, 8.9543, 2.1007)
instantaneousGrowth(177.378101, 87.096359, 15.9581, 8.9543)
instantaneousGrowth(547.267931, 177.378101, 22.9481, 15.9581)
instantaneousGrowth(1906.777418, 547.267931, 29.934, 22.9481)

# parra_g_2001_t204_2175_fig1a_fig5a_merged.csv
c(instantaneousGrowth(31.6275,14.0426,2.9733,0.0497),
instantaneousGrowth(51.1924,31.6275,4.9327,2.9733),
instantaneousGrowth(91.0548,51.1924,6.8925,4.9327),
instantaneousGrowth(135.4356,91.0548,9.9426,6.8925),
instantaneousGrowth(240.9009,135.4356,11.9667,9.9426),
instantaneousGrowth(619.1598,240.9009,14.955,11.9667),
instantaneousGrowth(947.0735,619.1598,17.0104,14.955),
instantaneousGrowth(1071.6018,947.0735,19.995,17.0104),
instantaneousGrowth(1235.6024,1071.6018,23.0117,19.995),
instantaneousGrowth(2679.9798,1235.6024,26.0634,23.0117))

# parra_g_2001_t204_2175_fig1b_fig5b_merged.csv
instantaneuousGrowth(24.9416,16.7727,4.9775,2.2163)
instantaneuousGrowth(38.8411,24.9416,7.9956,4.9775)
instantaneuousGrowth(43.3724,38.8411,10.0175,7.9956) 
instantaneuousGrowth(63.3093,43.3724,13.0352,10.0175)
instantaneuousGrowth(89.9108,63.3093,15.0262,13.0352)
instantaneuousGrowth(86.5901,89.9108,17.1116,15.0262)
instantaneuousGrowth(122.9773,86.5901,19.0063,17.1116)
instantaneuousGrowth(171.3921,122.9773,22.0881,19.0063)
instantaneuousGrowth(274.4193,171.3921,25.0421,22.0881)
instantaneuousGrowth(378.946,274.4193,28.0276,25.0421)
instantaneuousGrowth(584.8728,378.946,30.051,28.0276)

# rombough_pj_1994_f8_178_fig1_3_merged
# see rombough_pj_1994_f8_178_fig1_3_merged.R for details

# secor_dh_1998_f96_603
# directly extracted from paper

# tian_x_2010_a310_122_fig1_fig3a_merged.csv
#growth rates
instantaneousGrowth(15.9503, 13.5791, 4 , 1e-10)
instantaneousGrowth(19.7969, 15.9503, 8 , 4)
instantaneousGrowth(30.1477, 19.7969, 16, 8)
instantaneousGrowth(54.3913, 30.1477, 32, 16)
instantaneousGrowth(121.4758, 54.3913, 64, 32)
#metabolic rates 
34.0091*15.9503*0.21
32.9466*19.7969*0.21
32.8699*30.1477*0.21
28.8658*54.3913*0.21
22.2503*121.4758*0.21

# wieser_w_1988_f2_499_table1.csv
instantaneousGrowth(0.0025, 0.002,  11, 7)
instantaneousGrowth(0.0041, 0.0025, 14, 11)
instantaneousGrowth(0.0073, 0.0041, 18, 14)
instantaneousGrowth(0.0101, 0.0073, 21, 18)
instantaneousGrowth(0.0169, 0.0101, 25, 21)
instantaneousGrowth(0.0186, 0.0169, 27, 25)

# hansen_sl_2009_j74_1355_table_1_3.csv
# growth as g_d back calculated from last formula on last paragraph of page 1357
# G = (exp(g) - 1)*100, where g = (lnW1 - lnW0)/(t1-t0), just like on instantaneousGrowth
# back calculation is therefore g = ln(G/100 + 1)
log(1.18/100 + 1)
log(2.11/100 + 1)
log(3.24/100 + 1)

# lemos_d_2006_c144_33
# extracted from lemos_d_2006_c144_33_table3.csv

# solomon_dj_1972_j41_699_table2.csv
instantaneousGrowth( 13.70, 12.00, 28 + 1, 1)
instantaneousGrowth( 13.20, 10.80, 28 + 1, 1)
instantaneousGrowth( 18.75, 19.55, 28 + 1, 1)
instantaneousGrowth( 10.26, 10.45, 28 + 1, 1)
instantaneousGrowth( 13.65, 13.15, 29 + 1, 1)
instantaneousGrowth(7.35, 9.43,  31 + 1, 1)
instantaneousGrowth(7.29, 8.39,  28 + 1, 1)
instantaneousGrowth( 18.95, 18.51, 28 + 1, 1)
instantaneousGrowth( 11.30, 12.58, 54 + 1, 1)
instantaneousGrowth(6.70, 7.20,  30 + 1, 1)

# staples_dj_1976_j9_29_table3_fig5_merged.csv
instantaneousGrowth(4.02,3.62,46,1)
instantaneousGrowth(297,201.3,46,1)
instantaneousGrowth(1982,1334,46,1)

# weiser_w_1991_o87_500_table1.csv
instantaneousGrowth(3792,3232,3.96 +  1, 1)
instantaneousGrowth(3069,2936,1.67 +  1, 1)
instantaneousGrowth(3810,3617,1.00 +  1, 1)
instantaneousGrowth(2370,2241,1.33 +  1, 1)
instantaneousGrowth(3294,3077,1.25 +  1, 1)
instantaneousGrowth(2185,1870,4.04 +  1, 1)
instantaneousGrowth(2276,1954,4.04 +  1, 1)
instantaneousGrowth(2856,2549,4.04 +  1, 1)
instantaneousGrowth(3261,2946,4.04 +  1, 1)
instantaneousGrowth(2856,2532,4.04 +  1, 1)
instantaneousGrowth(3186,2742,4.04 +  1, 1)
instantaneousGrowth(2854,2332,4.04 +  1, 1)
instantaneousGrowth(3601,2866,4.04 +  1, 1)
instantaneousGrowth(5409,4608,4.04 +  1, 1)
instantaneousGrowth(4591,4034,4.04 +  1, 1)

# dabrowski_k_1984_a41_333
# directly extracted from paper

# day_oj_1996_a_27_831_fig1_fig3_merged
# 51.9Âµg is initial average mass provided on introduction"
instantaneousGrowth(77.5169 , 51.9     , 2.0283 , 1e-10)
instantaneousGrowth(78.2856 , 77.5169  , 3.0629 , 2.0283 )
instantaneousGrowth(86.1256 , 78.2856  , 4.0168 , 3.0629 )
instantaneousGrowth(108.0644, 86.1256  , 6.1025 , 4.0168 )
instantaneousGrowth(167.6322, 108.0644 , 8.1052 , 6.1025 )
instantaneousGrowth(217.9007, 167.6322 , 9.156  , 8.1052 )
instantaneousGrowth(514.7283, 217.9007 , 16.1267, 9.156  )
instantaneousGrowth(2187.914, 514.7283 , 24.0643, 16.1267)
instantaneousGrowth(7720.871, 2187.914 , 34.9491, 24.0643)

# finn_rn_1995_c111_647_fig1_fig5_merged.csv
instantaneousGrowth(167.2564, 137.9529, 6.655   , 3.7398 )
instantaneousGrowth(214.5225, 167.2564, 10.7927 , 6.655  )
instantaneousGrowth(263.9005, 214.5225, 13.9933 , 10.7927)
instantaneousGrowth(299.9767, 263.9005, 17.667  , 13.9933)
instantaneousGrowth(369.3721, 299.9767, 20.685  , 17.667 )
instantaneousGrowth(456.7088, 369.3721, 24.75   , 20.685 )
instantaneousGrowth(552.8444, 456.7088, 27.9341 , 24.75  )
instantaneousGrowth(738.2637, 552.8444, 32.9003 , 27.9341)

# oozeki_y_1994_j41_207_fig1_fig3_merged.csv
# see database-c-oozeki_y_1994_j41_207_fig1

# watson_am_2010_j41_224
# directly extracted from paper

# imsland_ak_1995_n34_149_fig1.csv
instantaneousGrowth(17.6552 , 15.9335 , 145.1957, 131.7327)
instantaneousGrowth(20.5979 , 17.6552 , 159.608 , 145.1957)
instantaneousGrowth(24.2716 , 20.5979 , 172.8433, 159.608 )
instantaneousGrowth(87.9298 , 71.8115 , 145.1957, 131.7327)
instantaneousGrowth(103.8049, 87.9298 , 159.608 , 145.1957)
instantaneousGrowth(124.5598, 103.8049, 172.8433, 159.608 )

# das_t_2005_j30_378_table3.csv
instantaneousGrowth(15.3 , 9.8   ,31, 1)
instantaneousGrowth(18.84, 10.36 ,31, 1)
instantaneousGrowth(17.38, 10.01 ,31, 1)
instantaneousGrowth(14.31, 9.99  ,31, 1)

# pichavant_k_2000_a188_103_fig2a_fig3a_merged.csv
instantaneousGrowth(172.8498, 151.1648, 30, 15)

# pichavant_k_2001_j59_875_fig1a.csv
instantaneousGrowth(158.5739, 129.6246, 42, 28)

# pichavant_k_2001_j59_875_fig1b.csv
instantaneousGrowth(86.823, 82.4882, 42, 28)

# burel_c_1996_j49_678_fig1e.csv
instantaneousGrowth(70.437  , 64.4605  , 85, 71)
instantaneousGrowth(83.6155 , 74.3437  , 85, 71)
instantaneousGrowth(92.0172 , 81.9219  , 85, 71)
instantaneousGrowth(103.5478, 86.5333  , 85, 71)

# foss_a_2003_a224_105_table1.csv
instantaneousGrowth(117.9, 95.5, 35, 1)

# person-le_ruyet_j_2004_a237_269_fig1.csv
instantaneousGrowth(108.1089, 100.4144, 56, 42)
instantaneousGrowth(123.3526, 110.4317, 56, 42)
instantaneousGrowth(143.6775, 125.9658, 56, 42)
instantaneousGrowth(158.9213, 137.1445, 56, 42)
instantaneousGrowth(177.0686, 148.7588, 56, 42)
instantaneousGrowth(176.3427, 153.2593, 56, 42)

# wood_ah_1932_j9_271_table1-2_merged.csv
instantaneousGrowth(0.02013, 0.01786, 59  , 57 )
instantaneousGrowth(0.04336, 0.02013, 68  , 59 )
instantaneousGrowth(0.05703, 0.04336, 71  , 68 )
instantaneousGrowth(0.06636, 0.05703, 73  , 71 )
instantaneousGrowth(0.07262, 0.06636, 75  , 73 )
instantaneousGrowth(0.09106, 0.07262, 78  , 75 )
instantaneousGrowth(0.11130, 0.09106, 83  , 78 )
instantaneousGrowth(0.06329, 0.05726, 90  , 86 )
instantaneousGrowth(0.07100, 0.06329, 93  , 90 )
instantaneousGrowth(0.07224, 0.07100, 94  , 93 )
instantaneousGrowth(0.09562, 0.07224, 105 , 94 )
instantaneousGrowth(0.11233, 0.09562, 114 , 105)
instantaneousGrowth(0.05184, 0.04446, 106 , 86 )
instantaneousGrowth(0.06482, 0.05184, 120 , 106)
instantaneousGrowth(0.06856, 0.06482, 128 , 120)
instantaneousGrowth(0.07928, 0.06856, 140 , 128)
instantaneousGrowth(0.09460, 0.07928, 164 , 140)

# degani_g_1985_j27_635_table2
instantaneousGrowth(0.73,0.7,25,1)

# niimi_aj_1974_c52_447
# extracted from niimi_aj_1974_c52_447_table3.csv

# jonassen_tm_2000_a30_219_fig2.csv
instantaneousGrowth(71.2035, 54.224, 135.5479, 105.5823)
instantaneousGrowth(29.4267 , 24.4421 , 136.0229 , 105.3126)

# laurence_gc_1975_m32_223_fig1-2_merged.csv
instantaneousGrowth(11.1916   , 10.1074  , 20.6871 , 13.9318)
instantaneousGrowth(29.545    , 10.1237  , 21.4324 , 7.0269 )
instantaneousGrowth(57.1085   , 29.545   , 27.9257 , 21.4324)
instantaneousGrowth(119.5085  , 57.1085  , 35.2303 , 27.9257)
instantaneousGrowth(636.5577  , 593.4673 , 63.3494 , 56.758 )
instantaneousGrowth(1014.7132 , 636.5577 , 77.3696 , 63.3494)
instantaneousGrowth(22.224    , 11.054   , 13.8548 , 5.4303 )
instantaneousGrowth(85.8351   , 22.224   , 21.0638 , 13.8548)
instantaneousGrowth(202.398   , 85.8351  , 28.3811 , 21.0638)
instantaneousGrowth(423.597   , 202.398  , 35.204  , 28.3811)
instantaneousGrowth(703.7799  , 423.597  , 42.3235 , 35.204 )
instantaneousGrowth(1404.1507 , 703.7799 , 49.4625 , 42.3235)
